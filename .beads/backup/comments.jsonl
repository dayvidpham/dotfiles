{"author":"David Huu Pham","created_at":"2026-02-23T02:00:19Z","id":1,"issue_id":"dotfiles-lgro","text":"Classification:\n  scope=module (tmux config — 2 files in modules/home-manager/programs/tmux/)\n  complexity=low (tmux built-in features: set-option, if-shell, user options, status-left format strings)\n  risk=internal-only (no breaking changes — adds runtime toggle on top of existing Nix-managed prefix default)\n  novelty=familiar (tmux user options + conditional bindings are well-documented patterns)"}
{"author":"David Huu Pham","created_at":"2026-02-23T02:23:33Z","id":2,"issue_id":"dotfiles-lgro","text":"Research depth: quick-scan (user confirmed)"}
{"author":"David Huu Pham","created_at":"2026-02-23T02:24:25Z","id":3,"issue_id":"dotfiles-lgro","text":"Research findings (quick-scan):\n- Standards: tmux extended-keys supports off/on/always (since tmux 3.2). 3.6a fully supports it.\n- Prior art: if-shell -F with user options (@prefix-mode) is the standard pattern for conditional runtime config.\n- IMPORTANT: M-S-Space (Alt+Shift+Space) is UNRELIABLE. tmux Shift modifier only works reliably with function keys and directional keys. Shift+Space is interpreted as plain Space at the terminal protocol level in most emulators, even with extended-keys enabled. This means M-S-Space would behave identically to M-Space (the current prefix), creating a conflict.\n- send-prefix rebinding is straightforward: unbind old, bind new to send-prefix.\n- Recommendation: Use an alternative toggle key (e.g., M-F12, F12, or M-\\)."}
{"author":"David Huu Pham","created_at":"2026-02-23T02:24:28Z","id":4,"issue_id":"dotfiles-lgro","text":"Explore findings (quick-scan):\n- Entry points: keybindings.tmux (primary, symlinked out-of-store for live editing), default.nix (Nix-managed prefix setting)\n- Related types: No existing user options (@-prefixed), no status-left/right config\n- Dependencies: Nix prefix = \"M-Space\" generates set -g prefix M-Space; runtime set -g prefix overrides this fine\n- Patterns: All keybindings are unconditional static bindings; no conditional/mode-aware bindings yet\n- Conflicts: None — clean namespace for @prefix-mode, no status bar config to clash with"}
{"author":"David Huu Pham","created_at":"2026-02-23T02:32:36Z","id":5,"issue_id":"dotfiles-lgro","text":"Toggle key updated: M-\\ (Alt+Backslash) — user confirmed after M-S-Space ruled out due to terminal key encoding limitations."}
{"author":"David Huu Pham","created_at":"2026-02-23T02:33:10Z","id":6,"issue_id":"dotfiles-lgro","text":"Toggle key updated: M-BTab (Alt+Shift+Tab) — user chose this over M-\\. BTab (backtab/Shift+Tab) produces a distinct CSI Z sequence, so M-BTab is a reliable root-table binding."}
{"author":"David Huu Pham","created_at":"2026-02-23T02:55:38Z","id":7,"issue_id":"dotfiles-cuaa","text":"Classification:\n  scope=cross-cutting (new shell script + zsh hook + tmux config + Nix packaging — touches 3-4 files across shell and tmux modules)\n  complexity=medium (registry data structure, git worktree detection, zsh chpwd hook integration, per-pane tmux styling, Nix wrapping)\n  risk=internal-only (no breaking changes — purely additive visual theming on top of existing tmux/zsh config)\n  novelty=moderate (chpwd hook → tmux set -p is a known pattern but not yet used in this codebase; worktree detection via .git file check is straightforward but needs careful path handling)"}
{"author":"David Huu Pham","created_at":"2026-02-23T03:06:40Z","id":8,"issue_id":"dotfiles-cuaa","text":"Research depth: standard (user confirmed)"}
{"author":"David Huu Pham","created_at":"2026-02-23T03:08:27Z","id":9,"issue_id":"dotfiles-cuaa","text":"Research findings (standard):\n- Standards: tmux set -p window-style bg=\u003ccolor\u003e works for per-pane backgrounds. pane-border-style and pane-active-border-style are WINDOW-level only (not per-pane).\n- Prior art: zsh chpwd_functions array is the standard hook for directory-change events. Combine with tmux pane-focus-in hook (requires focus-events on) for pane-switch coverage.\n- Patterns: Git worktree detection via [[ -f .git ]] is reliable (file = worktree, dir = main checkout). Worktree name from basename \"$(git rev-parse --git-dir)\".\n- Color support: tmux 3.6a fully supports hex colors (#rrggbb) in styles.\n- Caveat: pane-focus-in needs focus-events on (currently off in user's config).\n- Recommendation: chpwd hook for cd events + pane-focus-in hook for pane switching. Use set -p window-style for per-pane bg. Border color changes must be window-level."}
{"author":"David Huu Pham","created_at":"2026-02-23T03:08:33Z","id":10,"issue_id":"dotfiles-cuaa","text":"Explore findings (standard):\n- Entry points: tmux/default.nix (writeShellScriptBin pattern for scripts, home.packages), keybindings.tmux (pane-border-format line 67-68, status-left line 13), zsh/default.nix (precmd already used for vcs_info, chpwd NOT used yet)\n- Related types: ZSH initExtra for hook registration (line 165-189 in zsh/default.nix), chpwd_functions array\n- Dependencies: git (already in flake), standard POSIX tools only\n- Patterns: writeShellScriptBin + home.packages for scripts (sessionizer, move-window); mkOutOfStoreSymlink for live-editable config; balcony theme palette available (#20212C, #282B3C, #C0CAF5, #7A95C9, #414868)\n- Conflicts: None — all additive. No existing chpwd hooks. No per-pane styling. status-left already has prefix indicator (append, don't replace).\n- Notable: tmux 3.6 supports #{e|shell:...} in format strings but chpwd+set -p approach is more performant."}
{"author":"David Huu Pham","created_at":"2026-02-23T03:24:45Z","id":11,"issue_id":"dotfiles-o6ox","text":"VOTE: REVISE (Reviewer B, Test Quality) - Six findings requiring amendments: (1) double-fire behavior on chpwd+pane-focus-in unaddressed, (2) no error-path handling specified for git/tmux/config failures, (3) no testability guidance without Nix rebuild, (4) edge cases missing from BDD criteria (nested dirs, symlinks, bare repos), (5) config auto-creation needs mkdir -p and default content specification, (6) color lightening function needs visual validation criterion. See dotfiles-sx5m for full details."}
{"author":"David Huu Pham","created_at":"2026-02-23T03:24:57Z","id":12,"issue_id":"dotfiles-o6ox","text":"VOTE: ACCEPT (Reviewer C, Elegance axis) - Design is minimal, well-structured, and complexity-proportional. 4 components map 1:1 to problem decomposition. Config format fits scale. Auto-lighten is correct UX choice. Codebase patterns matched exactly. No component can be simplified without losing user-requested functionality. One minor clarification: proposal should explicitly state repo-name key is basename of git rev-parse --show-toplevel. See dotfiles-iyzf for full review."}
{"author":"David Huu Pham","created_at":"2026-02-23T03:26:29Z","id":13,"issue_id":"dotfiles-o6ox","text":"VOTE: ACCEPT (Reviewer A / Correctness) — All URD requirements R1-R5 are correctly addressed. tmux commands are valid, worktree detection is confirmed correct, pane-border-format nesting is syntactically sound, no race conditions, no plugin conflicts. Two minor recommendations for implementation: (1) pass #{pane_current_path} directly in pane-focus-in hook arg instead of querying tmux (avoids tmux#3506 edge case), (2) note that focus-events on is already set by tmux-sensible. Review task: dotfiles-roar"}
{"author":"David Huu Pham","created_at":"2026-02-23T03:28:02Z","id":14,"issue_id":"dotfiles-o6ox","text":"Superseded by PROPOSAL-2 (dotfiles-wqyb). Addresses all 6 findings from Review-B and 3 recommendations from Review-A."}
{"author":"David Huu Pham","created_at":"2026-02-23T03:29:32Z","id":15,"issue_id":"dotfiles-wqyb","text":"VOTE: ACCEPT (Reviewer B, Round 2) - All 6 findings from round 1 are adequately addressed. Error handling, testability, idempotency documentation, edge case BDD criteria, config auto-creation specifics, and color clamping are all resolved. See dotfiles-yvua for full review."}
{"author":"David Huu Pham","created_at":"2026-02-23T04:18:49Z","id":16,"issue_id":"dotfiles-m6xx","text":"Plan UAT: ACCEPT — 3 changes incorporated:\n1. Config key = full git remote URL (fallback to basename for local repos)\n2. Pane title for main checkout = git branch name (git branch --show-current)\n3. pane-border-format order reversed: #{pane_title} - #{session_name}:#{window_index}.#{pane_index}"}
{"author":"David Huu Pham","created_at":"2026-02-23T04:18:58Z","id":17,"issue_id":"dotfiles-wqyb","text":"RATIFIED: All 3 reviewers ACCEPT (A: dotfiles-roar, B round 2: dotfiles-yvua, C: dotfiles-iyzf), UAT passed (dotfiles-qs7h).\n\nUAT amendments to incorporate in implementation:\n1. Config key = full git remote URL (git remote get-url origin), fallback to basename\n2. Main checkout pane title = git branch name (git branch --show-current)\n3. pane-border-format order: #{pane_title} first, then #{session_name}:#{window_index}.#{pane_index}"}
{"author":"David Huu Pham","created_at":"2026-02-23T04:18:58Z","id":18,"issue_id":"dotfiles-m6xx","text":"Ratified: scope confirmed as PROPOSAL-2 + 3 UAT amendments"}
{"author":"David Huu Pham","created_at":"2026-02-23T04:23:04Z","id":19,"issue_id":"dotfiles-m6xx","text":"Implementation landed: commit 80c849d on main. All 3 files modified per ratified PROPOSAL-2. Pushed to origin."}
{"author":"David Huu Pham","created_at":"2026-02-23T04:23:05Z","id":20,"issue_id":"dotfiles-wqyb","text":"Implementation landed: commit 80c849d. feat(tmux): add git repo-based pane coloring with worktree indicators"}
{"author":"David Huu Pham","created_at":"2026-02-28T02:36:32Z","id":21,"issue_id":"dotfiles-evkd","text":"Classification: scope=single-file (home.desktop.nix or similar), complexity=low, risk=internal-only (symlink wiring, no public API change), novelty=familiar (mkOutOfStoreSymlink is an established NixOS home-manager pattern)"}
{"author":"David Huu Pham","created_at":"2026-02-28T02:39:39Z","id":22,"issue_id":"dotfiles-evkd","text":"Research depth: Quick scan (user confirmed)\nAdditional requirement from user: also add ~/dev/ and ~/codebases/dayvidpham as auto-trusted/auto-allowed whitelist prefix entries"}
{"author":"David Huu Pham","created_at":"2026-02-28T02:40:47Z","id":23,"issue_id":"dotfiles-evkd","text":"Research findings (quick scan):\n- Standards: direnv.toml only documents two top-level TOML sections: [global] (bash_path, disable_stdin, load_dotenv, strict_env, warn_timeout, hide_env_diff, log_format, log_filter) and [whitelist] (prefix, exact arrays). No include/import mechanism is documented anywhere.\n- Include directive: NO — The Config struct and tomlConfig struct in direnv source have no include/import/extends fields. The LoadConfig() function uses toml.DecodeFile() to parse a single file only. There is no multi-file merging logic. Source: https://github.com/direnv/direnv/blob/master/internal/cmd/config.go\n- Alternative mechanisms: None built-in. GitHub issue #1311 (opened 2024-08-16, still OPEN) requested a direnv_toml directive for .envrc files to switch which direnv.toml is loaded per-directory — that feature has NOT been implemented.\n- Recommendation: direnv.toml does NOT support includes. If config splitting is needed, it must be done at the generation layer (e.g., Nix concatenates config fragments into a single direnv.toml). There is no runtime mechanism to include another TOML file."}
{"author":"David Huu Pham","created_at":"2026-02-28T02:40:59Z","id":24,"issue_id":"dotfiles-evkd","text":"Explore findings (quick scan):\n\n- Entry points: Modify /home/minttea/dotfiles/users/minttea/home.nix\n  - Around line 170-183: the existing programs.direnv block (must remove/clear programs.direnv.config to avoid collision)\n  - Around line 299: the existing mkOutOfStoreSymlink pattern (SSH config) to adapt\n\n- Existing direnv.toml: Currently a store symlink managed by home-manager programs.direnv.config\n  lrwxrwxrwx -\u003e /nix/store/.../home-manager-files/.config/direnv/direnv.toml\n  Current generated content:\n    [global]\n    hide_env_diff = true\n    [whitelist]\n    prefix = [\"/home/minttea/dev/david-agent-data-leverage\"]\n\n- Conflict risk: YES — home-manager direnv module (modules/programs/direnv.nix line 191) writes:\n    xdg.configFile.\"direnv/direnv.toml\" = mkIf (cfg.config != {}) { source = tomlFormat.generate ... }\n  Setting both programs.direnv.config and xdg.configFile.\"direnv/direnv.toml\" (or home.file equivalent)\n  will cause a duplicate file definition error. Fix: set programs.direnv.config = {} (empty attrset)\n  or remove the config block entirely so the mkIf guard suppresses the generated file.\n\n- Pattern to follow (SSH config, line 299):\n    home.file.\".ssh/config\".source = config.lib.file.mkOutOfStoreSymlink /home/minttea/dotfiles/users/minttea/ssh/config;\n  Adapt for direnv.toml using xdg.configFile (not home.file) to match what the module uses:\n    xdg.configFile.\"direnv/direnv.toml\".source = config.lib.file.mkOutOfStoreSymlink /home/minttea/dotfiles/users/minttea/direnv/direnv.toml;\n\n- New file needed: /home/minttea/dotfiles/users/minttea/direnv/direnv.toml\n  Contents (to match current generated output):\n    [global]\n    hide_env_diff = true\n    [whitelist]\n    prefix = [\"/home/minttea/dev/david-agent-data-leverage\"]"}
{"author":"David Huu Pham","created_at":"2026-02-28T02:41:08Z","id":25,"issue_id":"dotfiles-evkd","text":"Research findings (quick scan):\n- Standards: direnv.toml documents exactly two top-level sections: [global] and [whitelist]. No include/import/extends/source directive exists.\n- Include directive: NO — direnv source (internal/cmd/config.go) uses toml.DecodeFile() on a single file with zero multi-file merging. Struct has no include fields.\n- Alternative mechanisms: None at runtime. GitHub issue #1311 (2024-08-16) requests this, remains unimplemented.\n- Recommendation: Config splitting must happen at the Nix generation layer (concatenate fragments during eval). Since we are using mkOutOfStoreSymlink (the file lives in dotfiles, not nix store), the entire config must be in one dotfiles-tracked file. Machine-local paths (like david-agent-data-leverage) must live in the same file as global entries.\n- Full findings: Research agent confirmed via source code analysis."}
{"author":"David Huu Pham","created_at":"2026-02-28T02:41:27Z","id":26,"issue_id":"dotfiles-evkd","text":"Explore findings (quick scan):\n- Entry point: home.nix, modify programs.direnv block (line 170-183) + add xdg.configFile entry\n- Existing direnv.toml: store symlink (nix-generated). Content: [global] hide_env_diff=true, [whitelist] prefix=[dev/david-agent-data-leverage]\n- CONFLICT RISK: YES — programs.direnv.config != {} causes module to write xdg.configFile.'direnv/direnv.toml'. Must set programs.direnv.config = {} to suppress.\n- Correct key: use xdg.configFile.'direnv/direnv.toml' (NOT home.file) to match what the module uses internally\n- Pattern to use: xdg.configFile.\"direnv/direnv.toml\".source = config.lib.file.mkOutOfStoreSymlink /home/minttea/dotfiles/users/minttea/direnv/direnv.toml;\n- New file needed: /home/minttea/dotfiles/users/minttea/direnv/direnv.toml"}
{"author":"David Huu Pham","created_at":"2026-02-28T02:46:53Z","id":27,"issue_id":"dotfiles-r3zx","text":"VOTE: ACCEPT (Reviewer C — Elegance axis)\n\nDesign is the simplest correct solution. Two files, minimal change, no over-engineering. xdg.configFile is the idiomatic home-manager API for XDG config. zeroing programs.direnv.config is unavoidable and correctly explained. File location follows the repo's own ssh/config convention. Core user value (edit file → immediate effect, no rebuild) is directly and precisely served.\n\nMinor: the stated reason for rejecting home.file ('potential parallel write') is slightly imprecise — the real reason to prefer xdg.configFile is idiom, not race avoidance. But the conclusion is correct and does not affect acceptance.\n\nReview task: dotfiles-mg44"}
{"author":"David Huu Pham","created_at":"2026-02-28T02:47:41Z","id":28,"issue_id":"dotfiles-r3zx","text":"VOTE: ACCEPT - All four correctness axes verified. mkIf guard suppression confirmed via nix eval. mkOutOfStoreSymlink invocation pattern matches established codebase conventions (ghostty, niri). xdg.configFile key matches module namespace exactly. TOML spec compliance confirmed via direnv docs. No technical errors found."}
{"author":"David Huu Pham","created_at":"2026-02-28T02:48:19Z","id":29,"issue_id":"dotfiles-r3zx","text":"Superseded by PROPOSAL-2 (dotfiles to be created). Reviewer B identified 4 falsifiability gaps in the validation checklist and BDD criteria."}
{"author":"David Huu Pham","created_at":"2026-02-28T02:53:36Z","id":30,"issue_id":"dotfiles-5qux","text":"VOTE: REVISE - Validation checklist build target is wrong. The nixosConfigurations.desktop build does NOT exercise home-manager changes (home-manager is managed as a separate homeConfigurations.\"minttea@desktop\" output, not wired as a NixOS module). Replace with: nix build '.#homeConfigurations.\"minttea@desktop\".activationPackage' --no-link. All other content (guard analysis, conflict resolution, BDD criteria, file content) is correct. Review task: dotfiles-ckmq."}
{"author":"David Huu Pham","created_at":"2026-02-28T02:53:59Z","id":31,"issue_id":"dotfiles-5qux","text":"Superseded by PROPOSAL-3. Both A-2 and B-2 found wrong build target: nixosConfigurations.desktop does not include home-manager. Correct target: homeConfigurations.\"minttea@desktop\".activationPackage"}
{"author":"David Huu Pham","created_at":"2026-02-28T02:56:26Z","id":32,"issue_id":"dotfiles-x0av","text":"VOTE: ACCEPT (Reviewer A, Round 3) - Round 2 BLOCKER resolved. Build target is now `nix build '.#homeConfigurations.\"minttea@desktop\".activationPackage' --no-link` which correctly targets the standalone home-manager config (confirmed in flake.nix). Removing `programs.direnv.config` is semantically identical to `config = {}` (module default verified in source). Conflict suppression logic is correct. Validation checklist is complete and verifiable. Review task: dotfiles-d6bf."}
{"author":"David Huu Pham","created_at":"2026-02-28T05:28:18Z","id":33,"issue_id":"dotfiles-x0av","text":"RATIFIED: All 3 reviewers ACCEPT (A-3: dotfiles-d6bf, B-3: dotfiles-oy69, C-3: dotfiles-6t18), Plan UAT passed (dotfiles-ee12)"}
{"author":"David Huu Pham","created_at":"2026-02-28T05:28:18Z","id":34,"issue_id":"dotfiles-7mlv","text":"Plan UAT: ACCEPT — user confirmed: remove config block entirely (not config={}), broad ~/dev/ prefix is correct, no missing requirements. Proposal dotfiles-x0av ratified."}
{"author":"David Huu Pham","created_at":"2026-02-28T19:14:36Z","id":35,"issue_id":"dotfiles-jc4y","text":"SLICE-1 implementation complete. Both leaf tasks done. Validation gates passed."}
{"author":"David Huu Pham","created_at":"2026-02-28T19:16:26Z","id":36,"issue_id":"dotfiles-vz4n","text":"VOTE: ACCEPT - Implementation matches ratified plan. All correctness criteria verified:\n- programs.direnv.config fully removed (not set to empty)\n- xdg.configFile wires mkOutOfStoreSymlink with absolute path to tracked file\n- Module mkIf guard suppresses duplicate definition conflict\n- Both whitelist prefixes present and correct\n- hide_env_diff preserved  \n- Related direnv settings unchanged\n\nQuality gates:\n- nix flake check --no-build: PASS\n- nix build homeConfigurations: PASS\n\nNo findings. Ready to close slice and proceed to completion."}
{"author":"David Huu Pham","created_at":"2026-02-28T19:16:50Z","id":37,"issue_id":"dotfiles-l5qc","text":"VOTE: ACCEPT - Implementation perfectly follows codebase patterns. xdg.configFile + mkOutOfStoreSymlink matches ghostty/niri precedents exactly. TOML file is idiomatic, Nix code style is consistent with home.nix conventions (2-space indentation, clean multi-line formatting). File placement in users/minttea/direnv/ follows repo directory conventions. Quality gates pass: nix flake check and nix build both succeed. No complexity, no artifacts."}
{"author":"David Huu Pham","created_at":"2026-02-28T19:20:19Z","id":38,"issue_id":"dotfiles-m1d2","text":"VOTE: REVISE - BLOCKER finding (dotfiles-ua77): BDD Acceptance Criterion #2 explicitly requires readlink (one-hop) to output the dotfiles path directly, not a /nix/store path. The current mkOutOfStoreSymlink approach creates a symlink chain through home-manager's generation, violating this requirement. This is a hard requirement for user acceptance - edits must be direct without indirection through managed symlinks."}
{"author":"David Huu Pham","created_at":"2026-02-28T19:21:50Z","id":39,"issue_id":"dotfiles-ua77","text":"FALSE POSITIVE — verified empirically against existing mkOutOfStoreSymlink pattern.\n\nGhostty config (same pattern, in production):\n  readlink ~/.config/ghostty/config → /nix/store/.../home-manager-files/.config/ghostty/config\n  readlink -f ~/.config/ghostty/config → /home/minttea/dotfiles/modules/home-manager/programs/ghostty/config\n\nThis is standard home-manager behavior: ALL xdg.configFile entries route through a generation directory. The one-hop readlink always shows the nix store path. The mkOutOfStoreSymlink ensures the FINAL target is the dotfiles path (readlink -f), and live edits are immediately visible.\n\nThe BDD criterion's \"readlink (one-hop)\" expectation is technically unachievable with standard home-manager xdg.configFile. The INTENT (mutable, out-of-store symlink to dotfiles) IS fully satisfied. This applies to every mkOutOfStoreSymlink in the codebase (ghostty, niri, etc.).\n\nResolution: false positive. No code change needed. BDD criterion clarification: readlink -f (not readlink) shows the dotfiles path."}
{"author":"David Huu Pham","created_at":"2026-02-28T19:32:18Z","id":40,"issue_id":"dotfiles-jc4y","text":"Review cycle 1 complete. Reviewer A: ACCEPT, Reviewer B: REVISE (1 BLOCKER — verified false positive, see dotfiles-ua77 comments), Reviewer C: ACCEPT. 2/3 ACCEPT, sole finding is false positive. Slice approved for UAT."}
{"author":"David Huu Pham","created_at":"2026-03-01T11:06:24Z","id":41,"issue_id":"dotfiles-h2xj","text":"Classification:\n- scope=module (new home-manager service module + wiring into existing sops/dolt config)\n- complexity=medium (systemd credential isolation, passphrase prompting via systemd-ask-password, tmpfs lifetime management, dependency ordering between services)\n- risk=internal-only (no breaking changes to existing services; additive module that other services opt into via After/Requires)\n- novelty=low-moderate (user has prior art in openclaw-vm project using LoadCredential/fw_cfg pattern; adapting to home-manager user services is the novel part)"}
{"author":"David Huu Pham","created_at":"2026-03-01T11:10:14Z","id":42,"issue_id":"dotfiles-h2xj","text":"Research depth: quick-scan (user confirmed). Prior art already available in ~/codebases/dayvidpham/nix-openclaw-vm/."}
{"author":"David Huu Pham","created_at":"2026-03-01T11:11:21Z","id":43,"issue_id":"dotfiles-h2xj","text":"Explore findings (quick-scan):\n- Entry points:\n  * modules/home-manager/services/dolt-server/default.nix — consumer, needs decrypted age key\n  * modules/home-manager/programs/beads/default.nix — uses sops.secrets (HM sops-nix), requires sops.age.keyFile\n  * users/minttea/home.nix — shared HM config, currently has sops.age.keyFile pointing to plaintext path (needs update)\n  * modules/home-manager/services/default.nix — service module registry (add new module here)\n- Existing credential pattern in this repo: syncthing/default.nix:92-106 uses LoadCredential + RuntimeDirectory + EnvironmentFile for per-service key isolation\n- Prior art (openclaw-vm): LoadCredential + per-service CREDENTIALS_DIRECTORY (mode 0700, systemd-managed)\n- Key design question: sops.age.keyFile must point to a path that exists both at switch-time AND at runtime. With tmpfs, the systemd service must run before switch.sh\n- Conflicts: sops.age.keyFile was just added (this session) pointing to plaintext path — needs to change to tmpfs path"}
{"author":"David Huu Pham","created_at":"2026-03-01T11:26:40Z","id":44,"issue_id":"dotfiles-emiw","text":"URD AMENDMENT (architecture change): During elicitation round 2, user agreed to shift from home-manager sops-nix with passphrase-protected user key to NixOS system-level sops-nix + LoadCredential pattern. This eliminates: (1) the sops-age-key user service, (2) passphrase prompting, (3) home-manager sops-nix dependency for beads. The system host key (/var/lib/sops-nix/keys.txt) decrypts secrets to /run/secrets/ (ramfs). User services access via direct path or LoadCredential. Requirements R1, R3, R4, R5, R6, R7 are superseded by this simpler approach. R2 (LoadCredential isolation) is retained."}
